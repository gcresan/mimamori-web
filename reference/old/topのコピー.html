<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - GCREV-INSIGHT</title>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif; background: #f5f7fa; color: #333; line-height: 1.8; }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header { background: #2c3e50; color: #fff; padding: 15px 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        .logo { font-size: 20px; font-weight: 700; }
        .user-info { font-size: 14px; }
        
        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        nav { background: #34495e; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        nav ul { list-style: none; display: flex; flex-wrap: wrap; max-width: 1400px; margin: 0 auto; }
        nav li { flex: 1; min-width: 120px; }
        nav a { display: block; padding: 15px 20px; color: #ecf0f1; text-decoration: none; text-align: center; transition: background 0.3s; }
        nav a:hover, nav a.active { background: #2c3e50; }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        main { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        .welcome { margin-bottom: 20px; }
        .welcome h1 { font-size: 28px; color: #2c3e50; margin-bottom: 10px; }
        .welcome p { color: #7f8c8d; }
        
        /* æœŸé–“åˆ‡æ›¿ã‚¿ãƒ– */
        .period-selector { background: #fff; border-radius: 8px; padding: 20px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .period-selector h2 { font-size: 16px; color: #2c3e50; margin-bottom: 15px; font-weight: 600; }
        .period-tabs { display: flex; gap: 10px; flex-wrap: wrap; }
        .period-tab { 
            flex: 1; 
            min-width: 150px;
            padding: 12px 20px; 
            background: #ecf0f1; 
            border: 2px solid #bdc3c7; 
            border-radius: 6px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 600;
            color: #555;
        }
        .period-tab:hover { background: #d5dbdb; border-color: #95a5a6; }
        .period-tab.active { background: #3498db; color: #fff; border-color: #3498db; box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3); }
        .period-tab .period-name { display: block; font-size: 15px; margin-bottom: 5px; }
        .period-tab .period-date { display: block; font-size: 12px; opacity: 0.8; }
        
        /* ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .dashboard-grid-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        
        /* ã‚«ãƒ¼ãƒ‰å…±é€š */
        .card { background: #fff; border-radius: 8px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 30px; }
        .card h2 { font-size: 18px; margin-bottom: 20px; color: #1e40af; border-left: 5px solid #2563eb; padding-left: 15px; }
        .card h3 { font-size: 16px; color: #333; margin: 25px 0 15px 0; padding-bottom: 8px; border-bottom: 2px solid #e5e7eb; }
        
        /* ã‚°ãƒ©ãƒ•ã‚³ãƒ³ãƒ†ãƒŠ */
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 450px; 
            margin: 20px auto;
            height: 300px;
        }
        .chart-container canvas {
            max-height: 300px;
        }
        
        /* çµè«–ã‚µãƒãƒªãƒ¼ */
        .summary-box { 
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: #0c4a6e; 
            padding: 30px; 
            border-radius: 8px; 
            margin-bottom: 30px; 
            line-height: 2; 
            border: 3px solid #0ea5e9;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.2);
        }
        .summary-box p { font-size: 15px; margin-bottom: 15px; }
        .summary-box strong { color: #0c4a6e; }
        
        /* è‰¯ã‹ã£ãŸç‚¹ãƒ»æ”¹å–„ç‚¹ */
        .good-box { 
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-left: 5px solid #10b981; 
            padding: 25px; 
            margin: 20px 0; 
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);
        }
        .good-box ul { margin: 15px 0 0 20px; }
        .good-box li { margin: 12px 0; line-height: 1.8; }
        
        .bad-box { 
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-left: 5px solid #ef4444; 
            padding: 25px; 
            margin: 20px 0; 
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.15);
        }
        .bad-box ul { margin: 15px 0 0 20px; }
        .bad-box li { margin: 12px 0; line-height: 1.8; }
        
        /* ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¨ãƒªã‚¢ãƒ»è€ƒå¯Ÿãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */
        .area-box { 
            background: linear-gradient(135deg, #fef9e7 0%, #fef3c7 100%);
            border-left: 5px solid #f59e0b; 
            padding: 25px; 
            margin: 20px 0; 
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);
        }
        
        .insight-box { 
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-left: 5px solid #3b82f6; 
            padding: 25px; 
            margin: 20px 0; 
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
        }
        
        .action-box {
            background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
            border-left: 5px solid #a855f7;
            padding: 25px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(168, 85, 247, 0.15);
        }
        
        /* æ¯”è¼ƒæœŸé–“æƒ…å ± */
        .comparison-info {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 13px;
            color: #2c3e50;
        }
        
        /* æ•°å€¤ã®è‰²åˆ†ã‘ */
        .number-down { color: #ef4444; font-weight: bold; }
        .number-up { color: #10b981; font-weight: bold; }
        .number-neutral { color: #6b7280; font-weight: bold; }
        .highlight { background-color: #fef08a; padding: 2px 6px; border-radius: 3px; font-weight: bold; }
        
        /* KPIã‚°ãƒªãƒƒãƒ‰ï¼ˆæ¨ç§»ã‚°ãƒ©ãƒ•çµ±åˆç‰ˆï¼‰ */
        .kpi-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin: 20px 0; 
        }
        .kpi-item { 
            text-align: center; 
            padding: 20px; 
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .kpi-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        .kpi-label { font-size: 12px; color: #6b7280; margin-bottom: 8px; font-weight: 600; }
        .kpi-value { font-size: 28px; font-weight: 700; color: #1e40af; margin: 10px 0; }
        .kpi-change { font-size: 13px; margin-top: 8px; font-weight: 600; margin-bottom: 15px; }
        
        /* KPIãƒŸãƒ‹ã‚°ãƒ©ãƒ•ï¼ˆã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ³ï¼‰ */
        .kpi-sparkline {
            height: 60px;
            margin-top: 15px;
            position: relative;
        }
        .kpi-sparkline canvas {
            width: 100% !important;
            height: 60px !important;
        }
        
        /* é‡è¦ãƒã‚¤ãƒ³ãƒˆ */
        .important-points {
            margin-top: 25px;
            padding: 20px;
            background: #fef2f2;
            border-left: 4px solid #ef4444;
            border-radius: 4px;
        }
        .important-points h3 {
            font-size: 16px;
            color: #991b1b;
            margin: 0 0 15px 0;
            border: none;
            padding: 0;
        }
        .important-points ul {
            margin: 0 0 0 20px;
            color: #991b1b;
        }
        .important-points li {
            margin: 8px 0;
            line-height: 1.6;
        }
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ« */
        table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 13px; }
        th, td { padding: 12px 10px; text-align: left; border-bottom: 1px solid #e5e7eb; }
        th { background-color: #f3f4f6; font-weight: bold; color: #374151; font-size: 12px; }
        tr:hover { background-color: #f9fafb; }
        td.number { text-align: right; font-family: 'Courier New', monospace; }
        
        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
        .progress-bar {
            height: 24px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            color: #fff;
            font-size: 12px;
            font-weight: 600;
            transition: width 0.5s ease;
        }
        .progress-fill.orange { background: linear-gradient(90deg, #f97316, #fb923c); }
        
        /* å„ªå…ˆåº¦ãƒãƒƒã‚¸ */
        .priority-high { background-color: #fee2e2; color: #991b1b; padding: 4px 12px; border-radius: 4px; font-weight: bold; font-size: 12px; display: inline-block; }
        .priority-medium { background-color: #fef3c7; color: #92400e; padding: 4px 12px; border-radius: 4px; font-weight: bold; font-size: 12px; display: inline-block; }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        .loading-overlay.active { display: flex; }
        .loading-spinner {
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ãƒœã‚¿ãƒ³ */
        .btn { 
            display: inline-block; 
            padding: 12px 24px; 
            background: #3498db; 
            color: #fff; 
            text-decoration: none; 
            border-radius: 6px; 
            transition: all 0.3s; 
            font-size: 14px; 
            border: none; 
            cursor: pointer; 
            font-weight: 600;
        }
        .btn:hover { background: #2980b9; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3); }
        .btn-secondary { background: #95a5a6; }
        .btn-secondary:hover { background: #7f8c8d; }
        .cta-buttons { margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap; }
        
        /* ãƒ•ãƒƒã‚¿ãƒ¼ */
        footer { background: #2c3e50; color: #ecf0f1; text-align: center; padding: 20px; margin-top: 50px; }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            nav ul { flex-direction: column; }
            nav li { min-width: 100%; }
            .kpi-grid { grid-template-columns: 1fr; }
            .dashboard-grid-2col { grid-template-columns: 1fr; }
            .cta-buttons { flex-direction: column; }
            .btn { width: 100%; text-align: center; }
            .period-tabs { flex-direction: column; }
            .period-tab { min-width: 100%; }
            table { font-size: 11px; }
            th, td { padding: 8px 5px; }
            .chart-container { max-width: 100%; height: 250px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">GCREV-INSIGHT</div>
            <div class="user-info">ã€‡ã€‡æ ªå¼ä¼šç¤¾ æ§˜</div>
        </div>
    </header>
    
    <nav>
        <ul>
            <li><a href="/dashboard" class="active">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a></li>
            <li><a href="/reports">æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</a></li>
            <li><a href="/topics">ãƒˆãƒ”ãƒƒã‚¯ã‚¹</a></li>
            <li><a href="/inquiry">å•ã„åˆã‚ã›</a></li>
            <li><a href="/resources">è³‡æ–™åº«</a></li>
            <li><a href="/account">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</a></li>
        </ul>
    </nav>
    
    <main>
        <div class="welcome">
            <h1>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
            <p>ã€‡ã€‡æ ªå¼ä¼šç¤¾ æ§˜ ã®æœ€æ–°æƒ…å ±</p>
        </div>
        
        <!-- æœŸé–“åˆ‡æ›¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="period-selector">
            <h2>ğŸ“… è¡¨ç¤ºæœŸé–“ã‚’é¸æŠ</h2>
            <div class="period-tabs">
                <div class="period-tab active" data-range="last30" onclick="changePeriod('last30')">
                    <span class="period-name">ç›´è¿‘30æ—¥</span>
                    <span class="period-date" id="date-last30">2025/12/27 - 2026/01/26</span>
                </div>
                <div class="period-tab" data-range="previousMonth" onclick="changePeriod('previousMonth')">
                    <span class="period-name">å‰æœˆ</span>
                    <span class="period-date" id="date-previousMonth">2025å¹´12æœˆï¼ˆ12/1 - 12/31ï¼‰</span>
                </div>
                <div class="period-tab" data-range="twoMonthsAgo" onclick="changePeriod('twoMonthsAgo')">
                    <span class="period-name">å‰ã€…æœˆ</span>
                    <span class="period-date" id="date-twoMonthsAgo">2025å¹´11æœˆï¼ˆ11/1 - 11/30ï¼‰</span>
                </div>
            </div>
        </div>
        
        <!-- 1. çµè«–ã‚µãƒãƒªãƒ¼ -->
        <div class="card">
            <h2>ğŸ“Š 1. çµè«–ã‚µãƒãƒªãƒ¼</h2>
            <div class="comparison-info" id="comparison-info">
                <strong>æ¯”è¼ƒæœŸé–“:</strong> å‰æœŸï¼ˆ2025/11/27 - 2025/12/26ï¼‰ã¨ã®æ¯”è¼ƒ
            </div>
            
            <div class="summary-box" id="summary-content">
                <p><strong>âš ï¸ å…¨ä½“ã®çŠ¶æ³ï¼š</strong>è¨ªå•è€…æ•°ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ï¼‰ã¯<span class="number-up">ã»ã¼æ¨ªã°ã„ï¼ˆ+0.0%ï¼‰</span>ã§å®‰å®šã—ã¦ã„ã¾ã™ãŒã€è‚å¿ƒã®<span class="number-down">ã‚¤ãƒ™ãƒ³ãƒˆç”³è¾¼ã¿ãŒæ¿€æ¸›ï¼ˆ10ä»¶â†’1ä»¶ã€-90%ï¼‰</span>ã—ã¦ãŠã‚Šã€æ·±åˆ»ãªçŠ¶æ³ã§ã™ã€‚</p>
                <p><strong>ğŸš¨ æœ€é‡è¦èª²é¡Œï¼š</strong>æ„›åª›çœŒã‹ã‚‰ã®è¨ªå•ãŒ<span class="number-down">646äººâ†’589äººï¼ˆ-8.8%æ¸›å°‘ï¼‰</span>ã—ã€å…¨ä½“ã«å ã‚ã‚‹å‰²åˆã‚‚<span class="number-down">15.6%â†’14.5%</span>ã«ä½ä¸‹ã€‚åœ°å…ƒã§ã‚ã‚‹æ„›åª›ã®é›†å®¢ãŒå¼±ã¾ã£ã¦ã„ã¾ã™ã€‚</p>
                <p><strong>ğŸ’¡ è€ƒãˆã‚‰ã‚Œã‚‹åŸå› ï¼š</strong>11æœˆã¯ã€Œæ±å£ç”Ÿã‚¨ã‚³ãƒã‚¦ã‚¹ã€ã€Œä¼Šäºˆå¸‚ã‚¨ã‚³ãƒã‚¦ã‚¹ã€ã®è¦‹å­¦ä¼šãŒè¤‡æ•°é–‹å‚¬ã•ã‚Œç”³è¾¼ã¿ãŒé›†ä¸­ã—ã¾ã—ãŸãŒã€12æœˆã¯å¤§ããªã‚¤ãƒ™ãƒ³ãƒˆãŒãªã‹ã£ãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
                <p><strong>ğŸ“± ãƒ‡ãƒã‚¤ã‚¹ï¼š</strong>ã‚¹ãƒãƒ›ã‹ã‚‰ã®è¨ªå•ãŒ<span class="number-up">56.9%</span>ã¨å¤šæ•°æ´¾ã§ã™ãŒã€ã‚¹ãƒãƒ›ã§ã®æ»åœ¨æ™‚é–“ã‚„ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ãŒä¼¸ã³æ‚©ã‚“ã§ã„ã¾ã™ã€‚</p>
            </div>
            
            <!-- ä¸»è¦KPIï¼ˆæ¨ç§»ã‚°ãƒ©ãƒ•ä»˜ãï¼‰ -->
            <div class="kpi-grid" id="kpi-container">
                <div class="kpi-item">
                    <div class="kpi-label">PVï¼ˆãƒšãƒ¼ã‚¸é–²è¦§æ•°ï¼‰</div>
                    <div class="kpi-value" id="kpi-pv">8,389</div>
                    <div class="kpi-change up" id="kpi-pv-change">â–² 0.4%</div>
                    <div class="kpi-sparkline">
                        <canvas id="sparkline-pv"></canvas>
                    </div>
                </div>
                <div class="kpi-item">
                    <div class="kpi-label">ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆè¨ªå•å›æ•°ï¼‰</div>
                    <div class="kpi-value" id="kpi-sessions">3,986</div>
                    <div class="kpi-change neutral" id="kpi-sessions-change">Â± 0.0%</div>
                    <div class="kpi-sparkline">
                        <canvas id="sparkline-sessions"></canvas>
                    </div>
                </div>
                <div class="kpi-item">
                    <div class="kpi-label">ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆè¨ªå•è€…æ•°ï¼‰</div>
                    <div class="kpi-value" id="kpi-users">3,502</div>
                    <div class="kpi-change up" id="kpi-users-change">â–² 3.5%</div>
                    <div class="kpi-sparkline">
                        <canvas id="sparkline-users"></canvas>
                    </div>
                </div>
                <div class="kpi-item">
                    <div class="kpi-label">æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼</div>
                    <div class="kpi-value" id="kpi-new-users">2,681</div>
                    <div class="kpi-change up" id="kpi-new-users-change">â–² 8.6%</div>
                    <div class="kpi-sparkline">
                        <canvas id="sparkline-new-users"></canvas>
                    </div>
                </div>
                <div class="kpi-item">
                    <div class="kpi-label">ãƒªãƒ”ãƒ¼ã‚¿ãƒ¼</div>
                    <div class="kpi-value" id="kpi-returning">821</div>
                    <div class="kpi-change down" id="kpi-returning-change">â–¼ 10.4%</div>
                    <div class="kpi-sparkline">
                        <canvas id="sparkline-returning"></canvas>
                    </div>
                </div>
                <div class="kpi-item">
                    <div class="kpi-label">å¹³å‡æ»åœ¨æ™‚é–“</div>
                    <div class="kpi-value" id="kpi-duration">47ç§’</div>
                    <div class="kpi-change up" id="kpi-duration-change">â–² 17.5%</div>
                    <div class="kpi-sparkline">
                        <canvas id="sparkline-duration"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- é‡è¦ãƒã‚¤ãƒ³ãƒˆ -->
            <div class="important-points">
                <h3>ğŸš¨ æœ€é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h3>
                <ul>
                    <li>æ„›åª›çœŒã‹ã‚‰ã®è¨ªå•ãŒ<strong>-8.8%æ¸›å°‘</strong>ï¼ˆç›®æ¨™ã¨é€†ã®çµæœï¼‰</li>
                    <li>ã‚¤ãƒ™ãƒ³ãƒˆç”³è¾¼ã¿ãŒ<strong>æ¿€æ¸›ï¼ˆ10ä»¶â†’1ä»¶ã€-90%ï¼‰</strong></li>
                    <li>é€šå¸¸ã®å•ã„åˆã‚ã›ã¯<strong>ä¾ç„¶ã¨ã—ã¦ã‚¼ãƒ­</strong></li>
                </ul>
            </div>
        </div>
        
        <!-- ãƒ‡ãƒã‚¤ã‚¹ãƒ»å¹´é½¢ã®å¯è¦–åŒ– -->
        <div class="dashboard-grid-2col">
            <!-- ãƒ‡ãƒã‚¤ã‚¹åˆ¥ -->
            <div class="card">
                <h2>ğŸ“± ãƒ‡ãƒã‚¤ã‚¹åˆ¥ã‚¢ã‚¯ã‚»ã‚¹</h2>
                <div class="chart-container">
                    <canvas id="deviceChart"></canvas>
                </div>
                <table id="deviceTable">
                    <thead>
                        <tr>
                            <th>ãƒ‡ãƒã‚¤ã‚¹</th>
                            <th>ã‚»ãƒƒã‚·ãƒ§ãƒ³</th>
                            <th>å‰²åˆ</th>
                            <th>CV</th>
                            <th>CVR</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ãƒ¢ãƒã‚¤ãƒ«</strong></td>
                            <td class="number">2,268</td>
                            <td class="number">56.9%</td>
                            <td class="number">0</td>
                            <td class="number">0.00%</td>
                        </tr>
                        <tr>
                            <td>ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—</td>
                            <td class="number">1,592</td>
                            <td class="number">39.9%</td>
                            <td class="number">1</td>
                            <td class="number">0.06%</td>
                        </tr>
                        <tr>
                            <td>ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ</td>
                            <td class="number">126</td>
                            <td class="number">3.2%</td>
                            <td class="number">0</td>
                            <td class="number">0.00%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- å¹´é½¢åˆ¥ -->
            <div class="card">
                <h2>ğŸ‘¥ å¹´é½¢åˆ¥ã‚¢ã‚¯ã‚»ã‚¹</h2>
                <div class="chart-container">
                    <canvas id="ageChart"></canvas>
                </div>
                <table id="ageTable">
                    <thead>
                        <tr>
                            <th>å¹´é½¢å±¤</th>
                            <th>ã‚»ãƒƒã‚·ãƒ§ãƒ³</th>
                            <th>å‰²åˆ</th>
                            <th>CV</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>25-34</td>
                            <td class="number">220</td>
                            <td class="number">32.4%</td>
                            <td class="number">2</td>
                        </tr>
                        <tr>
                            <td>35-44</td>
                            <td class="number">139</td>
                            <td class="number">20.5%</td>
                            <td class="number">1</td>
                        </tr>
                        <tr>
                            <td>18-24</td>
                            <td class="number">132</td>
                            <td class="number">19.5%</td>
                            <td class="number">0</td>
                        </tr>
                        <tr>
                            <td>45-54</td>
                            <td class="number">95</td>
                            <td class="number">14.0%</td>
                            <td class="number">0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- æµå…¥å…ƒ -->
        <div class="card">
            <h2>ğŸ”— æµå…¥å…ƒï¼ˆãƒ¡ãƒ‡ã‚£ã‚¢ã¨å‚ç…§å…ƒï¼‰</h2>
            <div class="chart-container" style="max-width: 500px;">
                <canvas id="mediaChart"></canvas>
            </div>
            
            <table id="mediaTable">
                <thead>
                    <tr>
                        <th>ãƒ¡ãƒ‡ã‚£ã‚¢</th>
                        <th>ã‚»ãƒƒã‚·ãƒ§ãƒ³</th>
                        <th>å‰²åˆ</th>
                        <th style="width: 200px;">ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ†å¸ƒ</th>
                        <th>CV</th>
                        <th>CVR</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>(none) - ç›´æ¥è¨ªå•</strong></td>
                        <td class="number">1,940</td>
                        <td class="number">37.4%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 37.4%;">37.4%</div>
                            </div>
                        </td>
                        <td class="number">158</td>
                        <td class="number"><strong>8.14%</strong></td>
                    </tr>
                    <tr>
                        <td>organic - è‡ªç„¶æ¤œç´¢</td>
                        <td class="number">1,848</td>
                        <td class="number">35.7%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 35.7%;">35.7%</div>
                            </div>
                        </td>
                        <td class="number">4</td>
                        <td class="number">0.22%</td>
                    </tr>
                    <tr>
                        <td>referral - ä»–ã‚µã‚¤ãƒˆ</td>
                        <td class="number">750</td>
                        <td class="number">14.5%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 14.5%;">14.5%</div>
                            </div>
                        </td>
                        <td class="number">0</td>
                        <td class="number">0.00%</td>
                    </tr>
                    <tr>
                        <td>paid - åºƒå‘Š</td>
                        <td class="number">373</td>
                        <td class="number">7.2%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 7.2%;">7.2%</div>
                            </div>
                        </td>
                        <td class="number">0</td>
                        <td class="number">0.00%</td>
                    </tr>
                    <tr>
                        <td>cpc - ã‚¯ãƒªãƒƒã‚¯åºƒå‘Š</td>
                        <td class="number">177</td>
                        <td class="number">3.4%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 3.4%;">3.4%</div>
                            </div>
                        </td>
                        <td class="number">0</td>
                        <td class="number">0.00%</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- åœ°åŸŸåˆ¥ã‚¢ã‚¯ã‚»ã‚¹ -->
        <div class="card">
            <h2>ğŸ“ åœ°åŸŸåˆ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆéƒ½é“åºœçœŒ TOP10ï¼‰</h2>
            <div class="chart-container" style="max-width: 100%; height: 400px;">
                <canvas id="regionChart"></canvas>
            </div>
            
            <table id="regionTable">
                <thead>
                    <tr>
                        <th>åœ°åŸŸ</th>
                        <th>ã‚»ãƒƒã‚·ãƒ§ãƒ³</th>
                        <th>å‰²åˆ</th>
                        <th style="width: 200px;">ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ†å¸ƒ</th>
                        <th>CV</th>
                        <th>CVR</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background: #fef9e7;">
                        <td><strong>æ„›åª›</strong></td>
                        <td class="number"><strong>816</strong></td>
                        <td class="number"><strong>15.3%</strong></td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill orange" style="width: 15.3%;">15.3%</div>
                            </div>
                        </td>
                        <td class="number"><strong>8</strong></td>
                        <td class="number"><strong>0.98%</strong></td>
                    </tr>
                    <tr>
                        <td>é–¢è¥¿</td>
                        <td class="number">839</td>
                        <td class="number">15.7%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 15.7%;">15.7%</div>
                            </div>
                        </td>
                        <td class="number">0</td>
                        <td class="number">0.00%</td>
                    </tr>
                    <tr>
                        <td>æ±äº¬</td>
                        <td class="number">725</td>
                        <td class="number">13.6%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 13.6%;">13.6%</div>
                            </div>
                        </td>
                        <td class="number">15</td>
                        <td class="number">2.07%</td>
                    </tr>
                    <tr>
                        <td>å¤§é˜ª</td>
                        <td class="number">372</td>
                        <td class="number">7.0%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 7.0%;">7.0%</div>
                            </div>
                        </td>
                        <td class="number">8</td>
                        <td class="number">2.15%</td>
                    </tr>
                    <tr>
                        <td>åŒ—æµ·é“</td>
                        <td class="number">186</td>
                        <td class="number">3.5%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 3.5%;">3.5%</div>
                            </div>
                        </td>
                        <td class="number">13</td>
                        <td class="number">6.99%</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; padding: 15px; background: #fef9e7; border-radius: 4px; border-left: 4px solid #f59e0b;">
                <strong>ğŸ’¡ é‡è¦ï¼š</strong>æ„›åª›çœŒã‹ã‚‰ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯<strong>816å›ï¼ˆ15.3%ï¼‰</strong>ã§ã€ç›®æ¨™ã‚¨ãƒªã‚¢ã‹ã‚‰ã®é›†å®¢ãŒå®‰å®šã—ã¦ã„ã¾ã™ã€‚å¼•ãç¶šã<span class="highlight">åœ°åŸŸSEOå¯¾ç­–</span>ã¨<span class="highlight">åœ°å…ƒã‚¤ãƒ™ãƒ³ãƒˆå‘ŠçŸ¥</span>ã‚’å¼·åŒ–ã—ã¾ã—ã‚‡ã†ã€‚
            </p>
        </div>
        

        <!-- ãƒšãƒ¼ã‚¸åˆ¥PV -->
        <div class="card">
            <h2>ğŸ“„ ã‚ˆãè¦‹ã‚‰ã‚Œã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ï¼ˆTOP10ï¼‰</h2>
            <table>
                <thead>
                    <tr>
                        <th style="width: 50%;">ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«</th>
                        <th>PV</th>
                        <th>å‰²åˆ</th>
                        <th style="width: 150px;">PVåˆ†å¸ƒ</th>
                        <th>Eã‚»ãƒƒã‚·ãƒ§ãƒ³</th>
                        <th>Eç‡</th>
                    </tr>
                </thead>
                <tbody id="page-ranking">
                    <tr>
                        <td>æ„›åª›çœŒæ¾å±±å¸‚ã®ãƒ‘ãƒƒã‚·ãƒ–ãƒã‚¦ã‚¹ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ä½å®…ã®å·¥å‹™åº—ï½œã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆå·¥æˆ¿Pure</td>
                        <td class="number">1,875</td>
                        <td class="number">20.7%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill orange" style="width: 100%;">20.7%</div>
                            </div>
                        </td>
                        <td class="number">2,215</td>
                        <td class="number">42.7%</td>
                    </tr>
                    <tr>
                        <td>ã‚¹ã‚¿ãƒƒãƒ•ãƒ–ãƒ­ã‚° - æ„›åª›çœŒæ¾å±±å¸‚ã®ãƒ‘ãƒƒã‚·ãƒ–ãƒã‚¦ã‚¹ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³æ³¨æ–‡ä½å®…</td>
                        <td class="number">559</td>
                        <td class="number">6.2%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill orange" style="width: 29.8%;">6.2%</div>
                            </div>
                        </td>
                        <td class="number">981</td>
                        <td class="number">85.5%</td>
                    </tr>
                    <tr>
                        <td>ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åŸºç¤ã¨ã—ã¦æ‰ãˆã‚‰ã‚Œã‚‹ã€3ï¼ˆã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã¨ã„ã†å˜ä½ã¨â€¦</td>
                        <td class="number">247</td>
                        <td class="number">2.7%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill orange" style="width: 13.2%;">2.7%</div>
                            </div>
                        </td>
                        <td class="number">536</td>
                        <td class="number">62.7%</td>
                    </tr>
                    <tr>
                        <td>æ–½å·¥äº‹ä¾‹ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ– - æ„›åª›çœŒæ¾å±±å¸‚ã®ãƒ‘ãƒƒã‚·ãƒ–ãƒã‚¦ã‚¹</td>
                        <td class="number">212</td>
                        <td class="number">2.3%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill orange" style="width: 11.3%;">2.3%</div>
                            </div>
                        </td>
                        <td class="number">328</td>
                        <td class="number">94.5%</td>
                    </tr>
                    <tr>
                        <td>ä¼šç¤¾æ¡ˆå†…ï½œæ„›åª›çœŒæ¾å±±å¸‚ã®ãƒ‘ãƒƒã‚·ãƒ–ãƒã‚¦ã‚¹ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³æ³¨æ–‡ä½å®…</td>
                        <td class="number">184</td>
                        <td class="number">2.0%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill orange" style="width: 9.8%;">2.0%</div>
                            </div>
                        </td>
                        <td class="number">291</td>
                        <td class="number">84.8%</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 4px; border-left: 4px solid #3b82f6;">
                <strong>ğŸ’¡ åˆ†æï¼š</strong>ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãŒ<strong>20.7%</strong>ã‚’å ã‚ã¦ãŠã‚Šã€å…¥å£ã¨ã—ã¦æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚ã‚¹ã‚¿ãƒƒãƒ•ãƒ–ãƒ­ã‚°ãŒ6.2%ã¨2ä½ã§ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ãŒæˆåŠŸã—ã¦ã„ã¾ã™ã€‚
            </p>
        </div>


        
        <!-- ã‚ˆãä½¿ã†æ©Ÿèƒ½ -->
        <div class="card">
            <h2>ğŸš€ ã‚ˆãä½¿ã†æ©Ÿèƒ½</h2>
            <div class="cta-buttons">
                <a href="/reports" class="btn">æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆä¸€è¦§</a>
                <a href="/topics" class="btn">ãƒˆãƒ”ãƒƒã‚¯ã‚¹ä¸€è¦§</a>
                <a href="/inquiry/new" class="btn">å•ã„åˆã‚ã›ã™ã‚‹</a>
                <a href="/resources" class="btn btn-secondary">è³‡æ–™åº«ã‚’è¦‹ã‚‹</a>
            </div>
        </div>
    </main>
    
    <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</p>
        </div>
    </div>
    
    <footer>
        <p>&copy; 2026 Your Company. All rights reserved.</p>
    </footer>
    
    <script>
        // Chart.jsã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¿æŒ
        let deviceChart, ageChart, mediaChart, regionChart;
        let sparklineCharts = {};
        let currentPeriod = 'last30';
        
        // Chart.jsãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
        Chart.defaults.font.family = "'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif";
        Chart.defaults.font.size = 11;
        
        // æœŸé–“åˆ‡æ›¿é–¢æ•°
        function changePeriod(range) {
            if (currentPeriod === range) return;
            
            document.querySelectorAll('.period-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-range="${range}"]`).classList.add('active');
            
            document.getElementById('loadingOverlay').classList.add('active');
            currentPeriod = range;
            fetchDashboardData(range);
        }
        
        // APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        async function fetchDashboardData(range) {
            try {
                const response = await fetch(`/api/ga4-summary?range=${range}`);
                
                if (!response.ok) {
                    throw new Error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
                
                const data = await response.json();
                updateDashboard(data);
                
                setTimeout(() => {
                    document.getElementById('loadingOverlay').classList.remove('active');
                }, 500);
                
            } catch (error) {
                console.error('Error fetching data:', error);
                
                // ãƒ‡ãƒ¢ç”¨: ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
                console.log('Using mock data for demonstration');
                const mockData = getMockData();
                updateDashboard(mockData);
                
                setTimeout(() => {
                    document.getElementById('loadingOverlay').classList.remove('active');
                }, 500);
            }
        }
        
        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
        function updateDashboard(data) {
            // æ¯”è¼ƒæœŸé–“æƒ…å ±ã‚’æ›´æ–°
            document.getElementById('comparison-info').innerHTML = 
                `<strong>æ¯”è¼ƒæœŸé–“:</strong> ${data.comparisonPeriod || 'å‰æœŸã¨ã®æ¯”è¼ƒ'}`;
            
            // KPIæ›´æ–°
            document.getElementById('kpi-pv').textContent = formatNumber(data.pageViews);
            document.getElementById('kpi-sessions').textContent = formatNumber(data.sessions);
            document.getElementById('kpi-users').textContent = formatNumber(data.users);
            document.getElementById('kpi-new-users').textContent = formatNumber(data.newUsers);
            document.getElementById('kpi-returning').textContent = formatNumber(data.returningUsers);
            document.getElementById('kpi-duration').textContent = data.avgDuration + 'ç§’';
            
            updateChangeIndicator('kpi-pv-change', data.pageViewsChange);
            updateChangeIndicator('kpi-sessions-change', data.sessionsChange);
            updateChangeIndicator('kpi-users-change', data.usersChange);
            updateChangeIndicator('kpi-new-users-change', data.newUsersChange);
            updateChangeIndicator('kpi-returning-change', data.returningUsersChange);
            updateChangeIndicator('kpi-duration-change', data.avgDurationChange);
            
            // ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ³ã‚°ãƒ©ãƒ•æ›´æ–°
            updateSparklines(data.trends);
            
            // ã‚°ãƒ©ãƒ•æ›´æ–°
            updateDeviceChart(data.devices);
            updateAgeChart(data.ageGroups);
            updateMediaChart(data.media);
            updateRegionChart(data.regions);
            
            // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
            updateDeviceTable(data.devices);
            updateAgeTable(data.ageGroups);
            updateMediaTable(data.media);
            updateRegionTable(data.regions);
        }
        
        // ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ³ï¼ˆãƒŸãƒ‹ã‚°ãƒ©ãƒ•ï¼‰æ›´æ–°
        function updateSparklines(trends) {
            const sparklineConfigs = [
                { id: 'sparkline-pv', data: trends.pageViews, color: '#3b82f6' },
                { id: 'sparkline-sessions', data: trends.sessions, color: '#3b82f6' },
                { id: 'sparkline-users', data: trends.users, color: '#10b981' },
                { id: 'sparkline-new-users', data: trends.newUsers, color: '#10b981' },
                { id: 'sparkline-returning', data: trends.returningUsers, color: '#ef4444' },
                { id: 'sparkline-duration', data: trends.avgDuration, color: '#f59e0b' }
            ];
            
            sparklineConfigs.forEach(config => {
                createSparkline(config.id, config.data, config.color);
            });
        }
        
        // ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ³ç”Ÿæˆ
        function createSparkline(canvasId, data, color) {
            const ctx = document.getElementById(canvasId);
            
            // æ—¢å­˜ã®ã‚°ãƒ©ãƒ•ã‚’ç ´æ£„
            if (sparklineCharts[canvasId]) {
                sparklineCharts[canvasId].destroy();
            }
            
            // ãƒ©ãƒ™ãƒ«ç”Ÿæˆï¼ˆæ—¥ä»˜ï¼‰
            const labels = data.labels || generateLabels(data.values.length);
            
            sparklineCharts[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data.values,
                        borderColor: color,
                        backgroundColor: `${color}33`, // 20% opacity
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 3,
                        pointHoverRadius: 5,
                        pointBackgroundColor: color,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                },
                                label: function(context) {
                                    return formatNumber(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: false
                        },
                        y: {
                            display: false,
                            beginAtZero: false
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }
        
        // ãƒ‡ãƒã‚¤ã‚¹åˆ¥ã‚°ãƒ©ãƒ•
        function updateDeviceChart(devices) {
            const ctx = document.getElementById('deviceChart');
            
            if (deviceChart) {
                deviceChart.destroy();
            }
            
            deviceChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: devices.map(d => d.name === 'mobile' ? 'ãƒ¢ãƒã‚¤ãƒ«' : d.name === 'desktop' ? 'ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—' : 'ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ'),
                    datasets: [{
                        data: devices.map(d => d.sessions),
                        backgroundColor: [
                            '#ef4444', // mobile - red
                            '#3b82f6', // desktop - blue
                            '#fbbf24'  // tablet - yellow
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: { size: 13 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${formatNumber(value)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // å¹´é½¢åˆ¥ã‚°ãƒ©ãƒ•
        function updateAgeChart(ageGroups) {
            const ctx = document.getElementById('ageChart');
            
            if (ageChart) {
                ageChart.destroy();
            }
            
            ageChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ageGroups.map(a => a.name),
                    datasets: [{
                        data: ageGroups.map(a => a.sessions),
                        backgroundColor: [
                            '#ec4899', // 18-24 - pink
                            '#3b82f6', // 25-34 - blue
                            '#06b6d4', // 35-44 - cyan
                            '#f97316', // 45-54 - orange
                            '#eab308', // 55-64 - yellow
                            '#22c55e'  // 65+ - green
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: { size: 13 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${formatNumber(value)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // æµå…¥å…ƒã‚°ãƒ©ãƒ•
        function updateMediaChart(media) {
            const ctx = document.getElementById('mediaChart');
            
            if (mediaChart) {
                mediaChart.destroy();
            }
            
            mediaChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: media.map(m => m.name),
                    datasets: [{
                        data: media.map(m => m.sessions),
                        backgroundColor: [
                            '#ef4444', // (none) - red
                            '#3b82f6', // organic - blue
                            '#fbbf24', // referral - yellow
                            '#ec4899', // paid - pink
                            '#10b981', // cpc - green
                            '#06b6d4', // display - cyan
                            '#8b5cf6', // social - purple
                            '#f97316'  // (not set) - orange
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 12,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${formatNumber(value)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // åœ°åŸŸåˆ¥ã‚°ãƒ©ãƒ•ï¼ˆæ¨ªæ£’ã‚°ãƒ©ãƒ•ï¼‰
        function updateRegionChart(regions) {
            const ctx = document.getElementById('regionChart');
            
            if (regionChart) {
                regionChart.destroy();
            }
            
            // TOP10ã®ã¿è¡¨ç¤º
            const top10 = regions.slice(0, 10);
            
            regionChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: top10.map(r => r.name),
                    datasets: [{
                        label: 'ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°',
                        data: top10.map(r => r.sessions),
                        backgroundColor: top10.map((r, i) => 
                            i === 0 ? '#f97316' : '#3b82f6' // 1ä½ã ã‘ã‚ªãƒ¬ãƒ³ã‚¸ã€ä»–ã¯é’
                        ),
                        borderWidth: 0
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.x || 0;
                                    return `ã‚»ãƒƒã‚·ãƒ§ãƒ³: ${formatNumber(value)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatNumber(value);
                                }
                            }
                        },
                        y: {
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: function(context) {
                                        return context.index === 0 ? 'bold' : 'normal';
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°é–¢æ•°
        function updateDeviceTable(devices) {
            const tbody = document.querySelector('#deviceTable tbody');
            tbody.innerHTML = '';
            
            devices.forEach(device => {
                const tr = document.createElement('tr');
                const deviceName = device.name === 'mobile' ? '<strong>ãƒ¢ãƒã‚¤ãƒ«</strong>' : 
                                  device.name === 'desktop' ? 'ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—' : 'ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ';
                tr.innerHTML = `
                    <td>${deviceName}</td>
                    <td class="number">${formatNumber(device.sessions)}</td>
                    <td class="number">${device.percentage.toFixed(1)}%</td>
                    <td class="number">${device.cv}</td>
                    <td class="number">${device.cvr.toFixed(2)}%</td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        function updateAgeTable(ageGroups) {
            const tbody = document.querySelector('#ageTable tbody');
            tbody.innerHTML = '';
            
            ageGroups.forEach(age => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${age.name}</td>
                    <td class="number">${formatNumber(age.sessions)}</td>
                    <td class="number">${age.percentage.toFixed(1)}%</td>
                    <td class="number">${age.cv}</td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        function updateMediaTable(media) {
            const tbody = document.querySelector('#mediaTable tbody');
            tbody.innerHTML = '';
            
            media.slice(0, 5).forEach(m => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${m.name === '(none)' ? '<strong>(none) - ç›´æ¥è¨ªå•</strong>' : m.name}</td>
                    <td class="number">${formatNumber(m.sessions)}</td>
                    <td class="number">${m.percentage.toFixed(1)}%</td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${m.percentage}%;">${m.percentage.toFixed(1)}%</div>
                        </div>
                    </td>
                    <td class="number">${m.cv}</td>
                    <td class="number">${m.name === '(none)' ? '<strong>' + m.cvr.toFixed(2) + '%</strong>' : m.cvr.toFixed(2) + '%'}</td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        function updateRegionTable(regions) {
            const tbody = document.querySelector('#regionTable tbody');
            tbody.innerHTML = '';
            
            regions.slice(0, 5).forEach((region, index) => {
                const tr = document.createElement('tr');
                if (index === 0) {
                    tr.style.background = '#fef9e7';
                }
                
                tr.innerHTML = `
                    <td>${index === 0 ? '<strong>' + region.name + '</strong>' : region.name}</td>
                    <td class="number">${index === 0 ? '<strong>' + formatNumber(region.sessions) + '</strong>' : formatNumber(region.sessions)}</td>
                    <td class="number">${index === 0 ? '<strong>' + region.percentage.toFixed(1) + '%</strong>' : region.percentage.toFixed(1) + '%'}</td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill ${index === 0 ? 'orange' : ''}" style="width: ${region.percentage}%;">${region.percentage.toFixed(1)}%</div>
                        </div>
                    </td>
                    <td class="number">${index === 0 ? '<strong>' + region.cv + '</strong>' : region.cv}</td>
                    <td class="number">${index === 0 ? '<strong>' + region.cvr.toFixed(2) + '%</strong>' : region.cvr.toFixed(2) + '%'}</td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        // å¤‰å‹•ç‡ã®è¡¨ç¤ºã‚’æ›´æ–°
        function updateChangeIndicator(elementId, changeValue) {
            const element = document.getElementById(elementId);
            element.classList.remove('up', 'down', 'neutral');
            
            if (changeValue > 0) {
                element.classList.add('up');
                element.textContent = `â–² ${changeValue}%`;
            } else if (changeValue < 0) {
                element.classList.add('down');
                element.textContent = `â–¼ ${Math.abs(changeValue)}%`;
            } else {
                element.classList.add('neutral');
                element.textContent = 'Â± 0.0%';
            }
        }
        
        // ãƒ©ãƒ™ãƒ«ç”Ÿæˆï¼ˆæ—¥ä»˜ï¼‰
        function generateLabels(count) {
            const labels = [];
            for (let i = count - 1; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i * 5); // 5æ—¥é–“éš”
                labels.push(`${date.getMonth() + 1}/${date.getDate()}`);
            }
            return labels;
        }
        
        // æ•°å€¤ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // æœŸé–“ã®æ—¥ä»˜è¡¨ç¤ºã‚’å‹•çš„ã«ç”Ÿæˆ
        function initializePeriodDates() {
            const today = new Date();
            
            const last30Start = new Date(today);
            last30Start.setDate(today.getDate() - 29);
            document.getElementById('date-last30').textContent = 
                `${formatDate(last30Start)} - ${formatDate(today)}`;
            
            const previousMonth = new Date(today.getFullYear(), today.getMonth() - 1, 1);
            const previousMonthEnd = new Date(today.getFullYear(), today.getMonth(), 0);
            document.getElementById('date-previousMonth').textContent = 
                `${previousMonth.getFullYear()}å¹´${previousMonth.getMonth() + 1}æœˆï¼ˆ${previousMonth.getMonth() + 1}/1 - ${previousMonth.getMonth() + 1}/${previousMonthEnd.getDate()}ï¼‰`;
            
            const twoMonthsAgo = new Date(today.getFullYear(), today.getMonth() - 2, 1);
            const twoMonthsAgoEnd = new Date(today.getFullYear(), today.getMonth() - 1, 0);
            document.getElementById('date-twoMonthsAgo').textContent = 
                `${twoMonthsAgo.getFullYear()}å¹´${twoMonthsAgo.getMonth() + 1}æœˆï¼ˆ${twoMonthsAgo.getMonth() + 1}/1 - ${twoMonthsAgo.getMonth() + 1}/${twoMonthsAgoEnd.getDate()}ï¼‰`;
        }
        
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}/${month}/${day}`;
        }
        
        // ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
        function getMockData() {
            return {
                comparisonPeriod: "å‰æœŸï¼ˆ2025/11/27 - 2025/12/26ï¼‰ã¨ã®æ¯”è¼ƒ",
                pageViews: 8389,
                pageViewsChange: 0.4,
                sessions: 3986,
                sessionsChange: 0.0,
                users: 3502,
                usersChange: 3.5,
                newUsers: 2681,
                newUsersChange: 8.6,
                returningUsers: 821,
                returningUsersChange: -10.4,
                avgDuration: 47,
                avgDurationChange: 17.5,
                trends: {
                    pageViews: {
                        labels: ['30æ—¥å‰', '25æ—¥å‰', '20æ—¥å‰', '15æ—¥å‰', '10æ—¥å‰', '5æ—¥å‰', 'æ˜¨æ—¥'],
                        values: [7800, 7650, 8100, 7900, 8300, 8500, 8389]
                    },
                    sessions: {
                        labels: ['30æ—¥å‰', '25æ—¥å‰', '20æ—¥å‰', '15æ—¥å‰', '10æ—¥å‰', '5æ—¥å‰', 'æ˜¨æ—¥'],
                        values: [3800, 3500, 4000, 3500, 4700, 5100, 4600]
                    },
                    users: {
                        labels: ['30æ—¥å‰', '25æ—¥å‰', '20æ—¥å‰', '15æ—¥å‰', '10æ—¥å‰', '5æ—¥å‰', 'æ˜¨æ—¥'],
                        values: [3200, 3100, 3400, 3300, 3600, 3700, 3502]
                    },
                    newUsers: {
                        labels: ['30æ—¥å‰', '25æ—¥å‰', '20æ—¥å‰', '15æ—¥å‰', '10æ—¥å‰', '5æ—¥å‰', 'æ˜¨æ—¥'],
                        values: [2300, 2200, 2500, 2400, 2700, 2800, 2681]
                    },
                    returningUsers: {
                        labels: ['30æ—¥å‰', '25æ—¥å‰', '20æ—¥å‰', '15æ—¥å‰', '10æ—¥å‰', '5æ—¥å‰', 'æ˜¨æ—¥'],
                        values: [950, 920, 880, 860, 840, 830, 821]
                    },
                    avgDuration: {
                        labels: ['30æ—¥å‰', '25æ—¥å‰', '20æ—¥å‰', '15æ—¥å‰', '10æ—¥å‰', '5æ—¥å‰', 'æ˜¨æ—¥'],
                        values: [42, 40, 43, 41, 45, 48, 47]
                    }
                },
                devices: [
                    { name: "mobile", sessions: 2268, percentage: 56.9, cv: 0, cvr: 0.00 },
                    { name: "desktop", sessions: 1592, percentage: 39.9, cv: 1, cvr: 0.06 },
                    { name: "tablet", sessions: 126, percentage: 3.2, cv: 0, cvr: 0.00 }
                ],
                ageGroups: [
                    { name: "25-34", sessions: 220, percentage: 32.4, cv: 2 },
                    { name: "35-44", sessions: 139, percentage: 20.5, cv: 1 },
                    { name: "18-24", sessions: 132, percentage: 19.5, cv: 0 },
                    { name: "45-54", sessions: 95, percentage: 14.0, cv: 0 },
                    { name: "55-64", sessions: 49, percentage: 7.2, cv: 0 },
                    { name: "65+", sessions: 43, percentage: 6.3, cv: 0 }
                ],
                media: [
                    { name: "(none)", sessions: 1940, percentage: 37.4, cv: 158, cvr: 8.14 },
                    { name: "organic", sessions: 1848, percentage: 35.7, cv: 4, cvr: 0.22 },
                    { name: "referral", sessions: 750, percentage: 14.5, cv: 0, cvr: 0.00 },
                    { name: "paid", sessions: 373, percentage: 7.2, cv: 0, cvr: 0.00 },
                    { name: "cpc", sessions: 177, percentage: 3.4, cv: 0, cvr: 0.00 },
                    { name: "display", sessions: 40, percentage: 0.8, cv: 0, cvr: 0.00 },
                    { name: "social", sessions: 36, percentage: 0.7, cv: 1, cvr: 2.78 },
                    { name: "(not set)", sessions: 13, percentage: 0.3, cv: 0, cvr: 0.00 }
                ],
                regions: [
                    { name: "æ„›åª›", sessions: 816, percentage: 15.3, cv: 8, cvr: 0.98 },
                    { name: "é–¢è¥¿", sessions: 839, percentage: 15.7, cv: 0, cvr: 0.00 },
                    { name: "æ±äº¬", sessions: 725, percentage: 13.6, cv: 15, cvr: 2.07 },
                    { name: "å¤§é˜ª", sessions: 372, percentage: 7.0, cv: 8, cvr: 2.15 },
                    { name: "åŒ—æµ·é“", sessions: 186, percentage: 3.5, cv: 13, cvr: 6.99 },
                    { name: "æ„›çŸ¥", sessions: 158, percentage: 3.0, cv: 3, cvr: 1.90 },
                    { name: "åºƒå³¶", sessions: 137, percentage: 2.6, cv: 6, cvr: 4.38 },
                    { name: "ç¥å¥ˆå·", sessions: 137, percentage: 2.6, cv: 1, cvr: 0.73 },
                    { name: "åƒè‘‰", sessions: 125, percentage: 2.3, cv: 13, cvr: 10.40 },
                    { name: "å…µåº«", sessions: 109, percentage: 2.0, cv: 5, cvr: 4.59 }
                ]
            };
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            initializePeriodDates();
            
            // åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ï¼ˆãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ï¼‰
            const initialData = getMockData();
            updateDashboard(initialData);
        });
    </script>
</body>
</html>
